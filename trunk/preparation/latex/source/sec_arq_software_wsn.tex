\subsection{Arquitectura de uma RSSF}
\label{sect:subsec_arq_sofware_wsn}
As redes de sensores têm uma arquitectura considerada minimalista porque, ao
contrário de outras arquitecturas de redes, estão organizadas em menos camadas,
fundindo algumas funções desempenhada por camadas inferiores para outras
superiores ( ex: a camada de aplicação pode desempenhar algumas funções da
normalmente atribuídas à camada de transporte). Assim, é fundamental perceber
qual a pilha de protocolos que as RSSFimplementam, bem como perceber quais os
sistemas que compõem um sensor genérico para de seguida apresentar algumas
implementações de sensores.

\subsubsection{Pilha de Protocolos de uma RSSF }
Uma arquitectura para a a pilha de protocolos em RSSF foi proposta por
\cite{Akyildiz2002}, esta pilha apresenta-se representada por cinco camadas:
física, ligação de dados, rede, transporte e aplicação. Tendo em conta as
características das RSSF, toda a pilha é acompanhada transversalmente por
três planos, que devem ser atendidos por cada uma das camadas, de forma a
lidarem de forma optima com a energia, mobilidade e recursos partilhados, e
estes são os seguintes: plano de gestão de tarefas , plano de gestão
de energia e plano de gestão de mobilidade. 
\begin{description}
 \item[Camada Física] Esta camada é responsável por selecção de frequência,
detecção de sinal e modulação, podendo ainda desempenhar algumas tarefas de
encriptação. A minimização do consumo de energia é uma prioridade, as restantes
tarefas assemelham-se às restantes redes sem fios. \cite{Akyildiz2002}. 

 \item[Camada de Ligação de Dados] Das tarefas associadas a esta camada
destacam-se as seguintes: multiplexação de dados, acesso ao meio, detecção de
erros e detecção de frames. Uma RSSF tem um protocolo de MAC especifico de modo
a atender o consumo de energia e os protocolos centrados nos dados. Assim sendo
e porque os ambientes de operação têm ruído e os sensores podem ser móveis, o
protocolo de acesso ao meio (MAC) tem que lidar com os constragimentos de
energia por forma a minimizar colisões a quando do \textit{broadcast} com os
vizinhos\cite{Akyildiz2002}. 

 \item[Camada de Rede] Sendo a energia um tema transversal a toda a pilha esta
camada deve endereçar esta preocupação também. No entanto, o facto das RSSF
serem essencialmente centradas nos dados, sensíveis à localização e com
endereçamento baseado em atributos faz com que estes assuntos sejam também
atendidos por esta camada\cite{Akyildiz2002}. Repare-se que se a camada de
ligação de dados se preocupa com a comunicação entre dois quaisquer nós, a
camada de rede deve decidir quais os nós a escolher. Um dos sistemas de
encaminhamento mais simples é o baseado na inundação (\textit{flooding}), no
entanto, apesar da simplicidade não tem alguns problemas como por exemplo: a
duplicação de mensagens e a total ignorância dos recursos da rede, nomeadamente
os energéticos, pois se um evento é detectado por mais que um sensor essa
informaçaõ vai enundar em duplicado pela rede. Um dos protocolos que minimiza o
impacto da inundação é o SPINS\cite{REF}, negociando e adaptando-se aos
recursos existentes. 

 \item[Camada de Transporte] Nas redes convencionais a camada de transporte
está responsável pela transmissão numa base ponto a ponto. Assim, uma das
tarefas importantes a apontar é a de gestão da congestão de tráfego na rede,
gestão da fiabilidade da comunicação\cite{TRANSPORT_LAYER_WSN}\cite{Iyer2005}.

%Esta camada surge com maior relevo quando importa a
%uma infraestrutura de RSSF comunicar com uma rede exterior. No entanto algumas
%das tarefas que podem ser desempenhadas por esta camada acabam por ser
%desempenhadas pela camada de aplicação, já que normalmente dizem respeito
%a qualidade de serviço ou certeza de entrega de  pacotes no destino.

 \item[Camada de aplicação] Várias são as aplicações ou protocolos
desenvolvidos para a camada aplicação normalmente estão associadas às
capacidades sensoriais das plataformas, que naturalmente estão relacionadas com
o fim para o qual se instala/desenha a RSSF. Alguns dos protocolos para
 camada aplicação referidos na literatura \cite{Akyildiz2002} são os seguintes:
\textit{Sensor Management Protocol} (SMP)\cite{SMP_REF} e Task Assignement and
Data Advertisement Protocol (TADAP)\cite{TADAP_REF}, realça-se no entanto, que
nesta área ainda existe muito caminho por percorrer e explorar. 
 \end{description}
Note-se no entanto que na implementação de alguns protocolos para RSSF algumas
camadas não estão presentes por exemplo um protocolo como o
LESOP\cite{LESOP_REF} as
camadas de rede e transporte não são consideradas por forma a simplificar a
pilha de protocolos em \textit{motes}. Esta é uma das capacidades destas redes,
que corresponde ao facto de adequar de forma especifica a infraestrutura às
necessidades de determinada aplicação.

\subsubsection{Modelo da plataforma genérica de uma RSSF - \textit{Mote}}
À semelhança do que acontece com as redes convencionais, existem nós de
computação interligados por uma infraestrutura de comunicação. No caso da RSSF,
esta infraestrutura corresponde a comunicação \textit{multi-hop} em que cada nó
da rede (\textit{mote}) pode desempenhar pelo menos três papeis: 1) Nó gerador
de dados, pela captação da eventos associados às especificidades dos sensores
possuídos; 2) Nó encaminhador, que recebe dados de outros nós e os passa a
outros nós por forma a que alcance o destino; 3) Nó de sincronização ou nó de
agregação, embora estas duas caracterizações não correspondam à mesma tarefa
por si só, a um nível mais macro, corresponde igualmente a colecção de dados da
rede oriundos da detecção de eventos, por forma a faze-la seguir agregada para
outro destino (interno ou externo à rede ). \\

Desta forma interessa perceber qual o modelo inerente a estas pequenas
plataformas de rede que apesar das características limitadoras da sua execução
conseguem executar uma complexidade de aplicações tendo em conta sempre as
limitações impostas pela arquitectura. Na figura seguinte apresent-se um
modelo \cite{ MODELO_SENSOR} que ilustra os diversos componentes que concorrem
para a efectividade de serviço de um \textit{mote} numa RSSF.
\input{pic_sensornode}
Como se pode observar pela figura, da qual se pode generalizar o modelo de uma
plataforma genérica de RSSF, os sistemas que estão presentes são os seguintes: 
i) Sistema de processamento;ii) Sistema de energia; iii) Sistema de
comunicação; iv) Sistema sensorial; v) Sistema de memória. Assim, importa
perceber com mais algum detalhe alguns destes sistemas e não menos importante
algumas caracterisiticas de sistemas operativos para estas plataformas
existentes na actualidade bem como conhecer genéricamente algumas
implementações usadas no desenho de RSSF.
 
\paragraph{Sistemas de energia}
Como já tem sido salientado ao longo deste trabalho e pode ser encontrado em
qualquer texto sobre RSSF, a energia é um recurso escasso e como tal deve ser
tomado em conta no desenho de redes de sensores, dependendo também da aplicação
ou dos eventos que se pretendem monitorizar bem como a frequência com que estes
se verificam. Assim, os dispositivos fornecedores de energia podem ser de
diversos tipos, por exemplo: baterias (tipo AA), baterias solares.
Encontra-se nas especificações das plataformas mais recentes os valores que
indicam o consumo energético nos diversos estados de operação de um
\textit{mote} a titulo de exemplo observe-se a plataforma 
\textit{Mica2}\cite{MICA} da \textit{Crossbows}\cite{CrossbowSite}:
\begin{table*}[ht]
\centering % used for centering table
\begin{tabular}{l r} % centered columns (4 columns)
\hline\hline %inserts double horizontal lines
Descrição & Valor \\ [0.5ex] % inserts table
%heading
\hline % inserts single horizontal line
Baterias& 2xAA \\ % inserting body of the table
Mínimo $V_{in}$ & 2.7 V \\
Capacidade da bateria& 2000 mAh \\
Regulada &  no \\
\hline %inserts single line
\end{tabular}
\label{table:mica2_caracter} % is used to refer this table in the text
 \caption{Características de energia do \textit{mote} Mica2
(origem:\cite{SNMuseum}))} % title of Table
\end{table*}



\begin{table*}[ht]
\centering % used for centering table
\begin{tabular}{l r} % centered columns (4 columns)
\hline\hline %inserts double horizontal lines
Operação & Consumo\\ [0.5ex] % inserts table
%heading
\hline % inserts single horizontal line
CPU \textit{sleep} com \textit{timer} \textit{on} & 0.054 mW \\ % inserting body
CPU activo,\textit{ radio }\textit{off} & 36 mW \\
CPU activo, \textit{radio idle listening }& 66 mW \\
CPU activo, \textit{radio TX/RX }& 117 mW \\
Potência Máxima (CPU activo, radio TX/RX + flash write) & 165 mW \\ [1ex] %
%[1ex] adds \hline %inserts single line
\end{tabular}
\label{table:mica2_powerops} % is used to refer this table in the text
 \caption{Consumo de Energia \textit{Mica2} - Operação Tipica
(origem:\cite{SNMuseum})} % title of Table
\end{table*}
\paragraph{Sistemas de processamento}
O sistema de processamento é um componente essencial num \textit{mote}
\cite{Holger_Karl_protocols_andarchs_wsn}. É responsável por recolher
informação de todos os sensores do nó processá-la em conformidade, tem ainda de
tratar a informação recebida de outros nós vizinhos. Toda o conjunto de
processamento pode ser realizado nas várias arquitecturas representando um
\textit{trade-off} entre desempenho, flexibilidade, performance, custo e
consumo de energia. Á semelhança do que acontece com os processadores de
computadores convencionais existem microprocessadores genéricos que podem ser
aplicados nas mais variadas aplicações, em especial estes processadores podem
entrar em modos de consumo reduzido (passando para o estado \textit{sleep})
quando não estão a efectuar processamento. Dois dos processadores mais
utilizados nas redes de sensores actuais são os da tecnologia Atmel Atmega 128L
\cite{atmel} e da Texas Instruments o controlador TI MSP430 \cite{TIMSP430}

\paragraph{Sistemas de comunicação}
Este sistema é o responsável pela transferência de dados entre diversos nós de
uma rede, no caso das RSSF, este sistema é de radio frequência que permite
dispor de uma rede sem necessidade de infraestrutura de cabos. A
rádio-frequência permite ter bom alcance de comunicação com boas taxas de
transferência, bem como equilibrar o consumo de energia perante existência de
erros. Assim para o uso efectivo deste tipo de comunicação é necessário
escolher bem a gama de frequência de operação que tipicamente se situam entre
as gamas 433 Mhz e 2.4Ghz.

Componente ainda fundamental é a existencia de transmissores e receptores
\footnote{No caso da implementação em RSSF, as plataformas incorporam num
mesmo componente as duas funções, transmissão e recepção, estes são denominados
por \textit{transceivers}}nos
nós. Estes têm a função de transformar uma cadeia de bits, vindas do
processador, em ondas electromagnéticas. Os estados pelos quais passam estes
compontes são os seguintes e estão associados essencialmente ao
consumo de energia: a trasmitir\footnote{o trasmissor está activo e a emitir
dados}, a receber\footnote{O receptor está activo e a receber dados},
\textit{idle}\footnote{Está livre para  receber dados, note-se que alguns
componentes de comunicação estão activos e outros estão desligados},
\textit{sleep}\footnote{A maior parte dos componentes de comunicação estão
desligados}.
Alguns dos sistemas de rádio existentes nas redes de sensores são os seguintes:
Xemics XE1205 \cite{XEMICS XE1205}, Chipcon 2420 (com chipset para
802.15.4) \cite{CHIPCON2420} 
\paragraph{Sistemas Operativos}
Os sistemas operativos (SO's) para as RSSF são menos complexos do que os
restantes SO's comuns para PC's. Esta especificidade deve-se, essencialmente às
limitações impostas pelas plataformas de execução, os \textit{motes}. Por
exemplo, as aplicações para RSSF não são interactivas daí não haver
necessidade de implementar interfaces gráficas nestes SO's. 
De seguida apresentam-se alguns sistemas operativos com vista a contribuir para
a compreensão do estado da arte nesta componente das RSSF.
\begin{description}
 \item[TinyOS\cite{tinyos}] Sistema operativo livre e de código aberto,
desenvolvido pela Universidade da California, Berkeley e implementado em nesC
(uma extensão da linguagem C) muito optimizado para as limitações de memória
existentes nas RSSF. É composto por diversos componentes, alguns representam
abstracções de \textit{hardware} que se ligam por intermédio de interfaces. O
modelo de execução orientado por eventos possibilita uma maior precisão na
gestão de energia, ainda assim tem grande flexibilidade no escalonamento dos
eventos gerados pelo ambiente real, que como se sabe são de natureza muito
imprevista.
 \item[Contiki\cite{Contiki}] Sistema operativo livre e de código aberto,
implementado em C, e tal como o TinyOS é orientado por eventos. As aplicações
podem ser carregadas e descarregadas em tempo de execução. Os processos deste
SO usam uma \textit{threads} leves, denominadas por protothreads que
proporciona um estilo de programação  \textit{threadlike} em cima do
\textit{kernel} orientado a eventos. Uma das inovações é a possibilidade de com
este SO se ter um modelo \textit{multithreading} por processo bem como um
mecanismo de comunicação entre processos usando mensagens.
 \item[Nano-RK\cite{nanork}] Sistema operativo desenvolvido na universidade de
Carnegie Mellon, o seu \textit{kernel} é baseado em execução em tempo real com 
\textit{multithreading } preemptivo. Assim é possivel ao \textit{kernel}
controlar que processos têm acesso ao CPU, com a divisão em fracções de tempo a
que cada processo acede ao CPU, à rede e aos sensores.
 \end{description}

\paragraph{Exemplos de Plataformas (\textit{motes})}
De forma breve apresentam-se algumas das implementações das plataformas usadas
nas RSSF, vários são os fabricantes e as caracteristicas que as distinguem com
a possibilidade de serem usadas nas mais variadas aplicações.
A tabela seguinte visa resumir várias plataformas:

{
\newcommand{\mc}[3]{\multicolumn{#1}{#2}{#3}}
\begin{table}[ht]
\centering
\begin{scriptsize}
 \begin{tabular}[]{|l||lllll}\cline{1-6}
\mc{6}{|c|}{\textbf{Características de Plataformas de RSSF}}\\\cline{1-6}
& \mc{5}{|c|}{\textbf{\textit{Motes}}}\\\hline\hline
\mc{1}{|c||}{\textbf{Características}} & \mc{1}{|c|}{\textbf{Mica2}} &
\mc{1}{c|}{\textbf{MicaZ}} & \mc{1}{c|}{\textbf{TelosB}} &
\mc{1}{c|}{\textbf{SunSpot}} & \mc{1}{c|}{\textbf{BTNode Rev3}}\\\hline

Micro Controlador & \mc{1}{c|}{Atmel AVR} & \mc{1}{c|}{12} & \mc{1}{c|}{13} &
\mc{1}{c|}{14} & \mc{1}{c|}{15}\\\hline
Energia & \mc{1}{c|}{2xAA / 2000 mAh} & \mc{1}{c|}{22} & \mc{1}{c|}{23} &
\mc{1}{c|}{24} &
\mc{1}{c|}{25}\\\hline
Memória & \mc{1}{c|}{31} & \mc{1}{c|}{32} & \mc{1}{c|}{33} & \mc{1}{c|}{34} &
\mc{1}{c|}{35}\\\hline
Comunicação & \mc{1}{c|}{Chipcon CC1000/310 MHz } & \mc{1}{c|}{42} &
\mc{1}{c|}{43} & \mc{1}{c|}{44}
& \mc{1}{c|}{45}\\\hline
Sensores/Actuadores & \mc{1}{c|}{51} & \mc{1}{c|}{52} & \mc{1}{c|}{53} &
\mc{1}{c|}{54} & \mc{1}{c|}{55}\\\hline
\end{tabular}
\end{scriptsize}
\caption{Comparação de Características de Plataformas de RSSF (Nós Sensores)}
\end{table}\label{tab:Caracterisiticas_motes}
}%




