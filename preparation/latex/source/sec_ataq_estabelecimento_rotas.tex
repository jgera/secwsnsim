\subsection{Ataques ao estabelecimento de rotas} \label{sect:subsec_ataq_est_rotas}
\paragraph*{\textbf{\textit{HELLO Flooding }}}
Este ataque explora os protocolos que fazem anunciar a sua próximidade, aos vizinhos, emitindo
mensagens de \textit{HELLO}, \cite{Survey_wsn_Sec_issues,Karlof2003}.
Os protocolos baseados na localização podem ser vulneráveis a este ataque, uma vez que, com um
dispositivo do tipo \textit{laptop-class}\cite{Karlof2003}, que possua um alcance rádio
suficientemente potente para cubrir toda a rede, permite anunciar-se a todos os nós como vizinho,
forçando a informação fluir através dele.
\paragraph*{\textbf{Ataque \textit{Sinkhole}}}
Nas RSSF um dos modos de comunicação é de um-para-muitos(\textit{one-to-many}). Este tipo
comunicação apresenta algumas vulnerabilidades a ataques do tipo
\textit{sinkhole}\cite{Sinkhole_attack}. Assim, um atacante informa os nós vizinhos, anunciando-se
como um nó que tem boa comunicação com o nó \textit{sink}, tornando-se assim um ponto de passagem de
informação. O ataque é realizado enviando pacotes de RREQ, alterando a origem e aumentando o número
de sequência como forma de garantir que a esta informação se sobrepõe a qualquer outra, legítima, da
rede. Em determinada altura, um atacante poderá ter, a passar por ele, um número elevado de rotas,
podendo, então, alterar ou encaminhar, de forma selectiva,  a informação. Os protocolos
\textit{table-driven} são vulneráveis a estes ataques, enquanto os protocolos baseados em
localização não o são, devido às suas rotas serem
\textit{on-demand}.\cite{Karlof2003,Survey_wsn_Sec_issues,Attaks_defenses_sec_in_wsn}
\paragraph*{\textbf{Ataque \textit{Wormhole}}}
Neste tipo de ataque, apresentado por Perrig et al \cite{Wormhole_perrig} a colaboração de dois nós
maliciosos (normalmente a muitos \textit{hops} de distância), colaboram para a
realizaçãoefectividade do ataque. Assim, os atacantes estabelecem uma ligação (ou
túnel, normalmente de melhor qualidade ou maior largura de banda) para comunicarem entre si.
Permitindo a um nó malicioso capturar pacotes ou partes de pacotes e enviá-los pela ligação privada
para o outro atacante no outro extremo da rede. Este ataque é particularmente eficaz em redes
\textit{ad-hoc} e redes baseadas em localização. Sendo estas compremetidas, não conseguiram
estabelecer caminhos maiores do que dois hops, causando interrupções
nas comunicações\cite{perrig_survey_ad_hoc,Survey_wsn_Sec_issues}.
Para além disso, este ataque transforma os atacantes em nós muito solicitados, pois
apresentam-se aos outros nós participantes como tendo uma melhor ligação e estar a menor
distância do destino.
\paragraph*{\textbf{Ataque \textit{Sybil}}}
Este ataque foi definido como um ataque que permitia atingir os mecanismos de redundância
em armazenamento distribuído em ambientes de ponto-a-ponto\cite{Douceur2002}. Outra
definição que surge, agora associada às RSSF, é a que o define como ``um dispositivo malicioso que
ilegitimamente assume múltiplas entidades''\cite{sybil_perrig}. Com estas definições e devido à sua
taxonomia, é um ataque bastante efectivo contra protocolos de encaminhamento\cite{Karlof2003}. Em
particular, os protocolos que adoptam múltiplos caminhos. Um nó ao assumir múltiplas identidades
oculta o facto dos dados estarem a passar por um único nó
malicioso\cite{Survey_wsn_Sec_issues,Attaks_defenses_sec_in_wsn}.
\subsubsection{Contra-medidas}
Uma das formas de prevenir um ataque HELLO flooding\cite{Karlof2003} é a implementação de
mecanismos de respostas(\textit{acknowlege}) a anúncios HELLO. Desta forma, caso o atacante esteja a
usar um meio de comunicação potente, que cubra toda a rede, caso um nó legítimo se encontre fora
do alcance de resposta, não considerará o anúncio como válido.  Para além deste mecanismo, é
possível proceder à autenticação da mensagem, certificando-a numa entidade central, que ao detectar
que um nó se anuncia como vizinho de muitos outros nós, pode tomar precauções, repudiando o nó
com a emissão de uma mensagem para toda a rede\cite{Survey_wsn_Sec_issues}.

Alguns autores têm vindo a desenvolver algoritmos que visam a detecção de atacantes que desencadeam
ataques do tipo \textit{Sinkhole}\cite{Sinkhole_attack}, um desses mecanismos é o \textit{Sinkhole
Intrusion Detection Sistem} (SIDS)\cite{Sinkhole_attack} orientado para a detecção destes ataques
ao protocolo DSR\cite{DSR}. Estes sistema propõe três mecanismos para detectar um atacante: i)
Discontinuidade de números de sequência,  tendo em conta que um atacante tentará usar números de
sequência muito grandes, assim um nó pode identificar os que crescem rápidamente ou que não
respeitam uma ordem crescente, considerandos um ataque; ii) Verificação de pacotes, os
vizinhos podem certificar a origem dos pacotes enviados por um nó. Isto será dificil de
realizar nos pacotes atacantes, uma vez que a origem é alterada. Assim, poder-se-á detectar
que a rede está sobre ataque, se circularem muitos pacotes não certificados; iii) Número de caminhos
a passar por um nó, cada nó pode observar a sua tabela de encaminhamento e se detectar que existem
muitos caminhos a passar pelo mesmo nó, pode estar na presença de um ataque do tipo
\textit{Sinkhole} e reagir a este facto\cite{Survey_wsn_Sec_issues,Attaks_defenses_sec_in_wsn}

A utilização de \textit{packet leashes}\cite{packet_leashes_perrig} permite mitigar o ataque
\textit{wormhole}. Assim, existem dois tipos de condições para se aceitar os pacotes vindos de uma
origem: baseado na localização e notempo. O primeiro, permite que um nó receptor, conhecendo a
localização da origem, saiba se um pacote atravessou a rede por um \textit{wormhole}, calculando
a distância entre os dois pontos. No segundo caso, baseia-se essencialmente no tempo de transmissão
do pacote, exigindo então a sincronização de relógios. Se for muito rápido a chegar ao destino, este
nó assume que se está perante um ataque de \textit{wormhole}.

Para o ataque \textit{sybil} em \cite{sybil_perrig,Survey_wsn_Sec_issues}, são possíveis dois
esquemas de protecção: i) \textit{Radio resource testing} (cada vizinho só pode transmitir num
canal, selecciona um canal para receber e enviar uma mensagem, os nós que não responderem são
tratados como falsos); \textit{Random key distribution}(usando um modelo de \textit{key-pool} são
atribuidas $n$ chaves de um conjunto de $m$. Se dois nós partilharem $q$ chaves então estarão em
condições de comunicar de forma segura. Uma função de dispersão, com base no identificador do nó,
permite gerar chaves, evitando que um nó possa conhecer uma grande parte das chaves).